define(["marionette","text!app/templates/partials/page.html"],function(e,t){"use strict";return Backbone.Marionette.ItemView.extend({template:t,className:"expand",events:{"click .previous":"onClickPrevious","click .next":"onClickNext","click .pageChange":"onClickPageChange","change .pageChange":"onChangePage"},templateData:{loading:!0},initialize:function(e){_.isEmpty(e.filter)&&(e.filter={}),this.filter=e.filter,this.triggerFetch()},triggerFetch:function(){var e=this;this.options.collection.fetch({data:_.merge(this.options.filter,{count:1}),success:function(t){t=t.toJSON(),e.serializeData(t[0].count)}})},serializeData:function(e){this.filter.to=_.has(this.filter,"to")?parseInt(this.filter.to):100,this.filter.from=_.has(this.filter,"from")?parseInt(this.filter.from):0;var e=parseInt(e);this.templateData={loading:!1,totalItems:parseInt(e),totalPages:parseInt(e/this.filter.to)+1,perPage:parseInt(this.filter.to),offset:this.filter.from,currentPage:parseInt(this.filter.from/this.filter.to+1)},this.render()},onClickPrevious:function(){if(this.templateData.currentPage!=1)return this.filter.from=parseInt(this.filter.from)-parseInt(this.filter.to),MyApp.vent.trigger("paging:update",{from:this.filter.from,to:parseInt(this.filter.to)}),this.triggerFetch()},onClickNext:function(){if(this.templateData.currentPage!=this.templateData.totalPages)return this.filter.from=parseInt(this.filter.from)+parseInt(this.filter.to),MyApp.vent.trigger("paging:update",{from:this.filter.from,to:parseInt(this.filter.to)}),this.triggerFetch()},onClickPageChange:function(e){var t=parseInt($(e.currentTarget).data("page")-1);return MyApp.vent.trigger("paging:update",{from:t*this.filter.to,to:parseInt(this.filter.to)}),this.triggerFetch()},onChangePage:function(e){var t=parseInt($(e.currentTarget).val())-1;return MyApp.vent.trigger("paging:update",{from:t*this.filter.to,to:parseInt(this.filter.to)}),this.triggerFetch()},render:function(){if(this.templateData.loading===!1){var e=_.template($(t).html(),this.templateData);this.$el.html(e)}return this}})});